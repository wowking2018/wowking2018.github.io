<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Wave physics as an analog recurrent neural network | Love and Share</title>
<meta name="keywords" content="Machine learning">
<meta name="description" content="RNNä»‹ç» RNN(å¾ªç¯ç¥ç»ç½‘ç»œ)æ˜¯åœ¨è‡ªç„¶è¯­è¨€å¤„ç†NLPé¢†åŸŸä¸­æœ€å…ˆè¢«ç”¨èµ·æ¥çš„ï¼Œæ¯”å¦‚ï¼ŒRNNå¯ä»¥ä¸ºè¯­è¨€æ¨¡å‹æ¥å»ºæ¨¡. å¾ªç¯ç¥ç»ç½‘ç»œç§ç±»ç¹å¤šï¼Œæœ€ç®€å•çš„">
<meta name="author" content="wowking">
<link rel="canonical" href="https://wowking2018.github.io/posts/2023-01-10-wave-physics-as-an-analog-recurrent-neural-network/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fa3a950dc53e39fd52e88f8aa4fe3534775854957275bcd2b38a217fb10f2c14.css" integrity="sha256-&#43;jqVDcU&#43;Of1S6I&#43;KpP41NHdYVJVydbzSs4ohf7EPLBQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://wowking2018.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://wowking2018.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://wowking2018.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://wowking2018.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://wowking2018.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://wowking2018.github.io/posts/2023-01-10-wave-physics-as-an-analog-recurrent-neural-network/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>






<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            displayMath: [['$$','$$']], 
            inlineMath: [['$','$']],
        },
        TeX: {equationNumbers: {autoNumber: "AMS"}},
    });
</script>






  

<meta property="og:title" content="Wave physics as an analog recurrent neural network" />
<meta property="og:description" content="RNNä»‹ç» RNN(å¾ªç¯ç¥ç»ç½‘ç»œ)æ˜¯åœ¨è‡ªç„¶è¯­è¨€å¤„ç†NLPé¢†åŸŸä¸­æœ€å…ˆè¢«ç”¨èµ·æ¥çš„ï¼Œæ¯”å¦‚ï¼ŒRNNå¯ä»¥ä¸ºè¯­è¨€æ¨¡å‹æ¥å»ºæ¨¡. å¾ªç¯ç¥ç»ç½‘ç»œç§ç±»ç¹å¤šï¼Œæœ€ç®€å•çš„" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wowking2018.github.io/posts/2023-01-10-wave-physics-as-an-analog-recurrent-neural-network/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-01-10T12:14:32+08:00" />
<meta property="article:modified_time" content="2023-01-10T12:14:32+08:00" /><meta property="og:site_name" content="ğŸ‘‹ Welcome" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Wave physics as an analog recurrent neural network"/>
<meta name="twitter:description" content="RNNä»‹ç» RNN(å¾ªç¯ç¥ç»ç½‘ç»œ)æ˜¯åœ¨è‡ªç„¶è¯­è¨€å¤„ç†NLPé¢†åŸŸä¸­æœ€å…ˆè¢«ç”¨èµ·æ¥çš„ï¼Œæ¯”å¦‚ï¼ŒRNNå¯ä»¥ä¸ºè¯­è¨€æ¨¡å‹æ¥å»ºæ¨¡. å¾ªç¯ç¥ç»ç½‘ç»œç§ç±»ç¹å¤šï¼Œæœ€ç®€å•çš„"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://wowking2018.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Wave physics as an analog recurrent neural network",
      "item": "https://wowking2018.github.io/posts/2023-01-10-wave-physics-as-an-analog-recurrent-neural-network/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Wave physics as an analog recurrent neural network",
  "name": "Wave physics as an analog recurrent neural network",
  "description": "RNNä»‹ç» RNN(å¾ªç¯ç¥ç»ç½‘ç»œ)æ˜¯åœ¨è‡ªç„¶è¯­è¨€å¤„ç†NLPé¢†åŸŸä¸­æœ€å…ˆè¢«ç”¨èµ·æ¥çš„ï¼Œæ¯”å¦‚ï¼ŒRNNå¯ä»¥ä¸ºè¯­è¨€æ¨¡å‹æ¥å»ºæ¨¡. å¾ªç¯ç¥ç»ç½‘ç»œç§ç±»ç¹å¤šï¼Œæœ€ç®€å•çš„",
  "keywords": [
    "Machine learning"
  ],
  "articleBody": "RNNä»‹ç» RNN(å¾ªç¯ç¥ç»ç½‘ç»œ)æ˜¯åœ¨è‡ªç„¶è¯­è¨€å¤„ç†NLPé¢†åŸŸä¸­æœ€å…ˆè¢«ç”¨èµ·æ¥çš„ï¼Œæ¯”å¦‚ï¼ŒRNNå¯ä»¥ä¸ºè¯­è¨€æ¨¡å‹æ¥å»ºæ¨¡. å¾ªç¯ç¥ç»ç½‘ç»œç§ç±»ç¹å¤šï¼Œæœ€ç®€å•çš„åŸºæœ¬å¾ªç¯ç¥ç»ç½‘ç»œå¯ä»¥è¢«ç†è§£ä¸ºéšè—å±‚å†…å¾ªç¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nå¦‚æœæˆ‘ä»¬æŠŠä¸Šé¢çš„å›¾å±•å¼€ï¼Œå¾ªç¯ç¥ç»ç½‘ç»œä¹Ÿå¯ä»¥ç”»æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š\nç°åœ¨çœ‹ä¸Šå»å°±æ¯”è¾ƒæ¸…æ¥šäº†ï¼Œè¿™ä¸ªç½‘ç»œåœ¨ $t$ æ—¶åˆ»æ¥æ”¶åˆ°è¾“å…¥ $\\mathrm{x}_ {t}$ ä¹‹åï¼Œéšè—å±‚çš„å€¼æ˜¯ $\\mathrm{s} _ {t}$ ï¼Œè¾“å‡ºå€¼æ˜¯ $\\mathrm{o}_ {t}$. å…³é”®ä¸€ç‚¹æ˜¯ï¼Œ $\\mathrm{s}_ {t}$ çš„å€¼ä¸ä»…ä»…å–å†³äº $\\mathrm{x}_ {t}$ , è¿˜å–å†³äº $\\mathrm{s}_ {t-1}$ . æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼æ¥è¡¨ç¤ºå¾ªç¯ç¥ç»ç½‘ç»œçš„è®¡ç®—æ–¹æ³•:\n$$ \\begin{equation} \\begin{aligned} \u0026 \\mathrm{o}_t=g\\left(V \\mathrm{~s}_t\\right)\\\\ \u0026 \\left.\\mathrm{s}_t=f\\left(U \\mathrm{x}_t+W \\mathrm{~s}_{t-1}\\right) \\right. \\end{aligned} \\label{eq1} \\end{equation} $$ è¾“å‡ºå±‚æ˜¯ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œä¹Ÿå°±æ˜¯å®ƒçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œéš è—å±‚çš„æ¯ä¸ªèŠ‚ç‚¹ç›¸è¿. $\\mathrm{V}$ æ˜¯è¾“å‡ºå±‚çš„æƒé‡çŸ©é˜µï¼Œ $g$ æ˜¯æ¿€æ´»å‡½æ•°. éšè—å±‚æ˜¯å¾ªç¯å±‚. ${U}$ æ˜¯è¾“å…¥ $x$ çš„æƒé‡çŸ©é˜µï¼Œ ${W}$ æ˜¯ä¸Šä¸€æ¬¡çš„å€¼ $\\mathrm{s}_ {t-1}$ ä½œä¸ºè¿™ä¸€æ¬¡çš„ è¾“å…¥çš„æƒé‡çŸ©é˜µï¼Œ $f$æ˜¯æ¿€æ´»å‡½æ•°.\nä» Eq. \\eqref{eq1} ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¾ªç¯å±‚å’Œå…¨è¿æ¥å±‚çš„åŒºåˆ«å°±æ˜¯å¾ªç¯å±‚å¤šäº†ä¸€ä¸ªæƒé‡çŸ©é˜µ $W$. å¦‚æœåå¤æŠŠéšè—å±‚çš„è®¡ç®—å…¬å¼å¸¦å…¥åˆ°è¾“å‡ºå±‚ï¼Œæˆ‘ä»¬å°†å¾—åˆ°:\n$$ \\begin{equation} \\begin{aligned} \\mathrm{o}_t \u0026 =g\\left(V \\mathrm{~s}_t\\right) \\\\ \u0026 =V f\\left(U \\mathrm{x}_t+W \\mathrm{~s}_{t-1}\\right) \\\\ \u0026 =V f\\left(U \\mathrm{x}_t+W f\\left(U \\mathrm{x}_{t-1}+W \\mathrm{~s}_{t-2}\\right)\\right) \\\\ \u0026 =V f\\left(U \\mathrm{x}_t+W f\\left(U \\mathrm{x}_{t-1}+W f\\left(U \\mathrm{x}_{t-2}+W \\mathrm{~s}_{t-3}\\right)\\right)\\right) \\\\ \u0026 =V f\\left(U \\mathrm{x}_t+W f\\left(U \\mathrm{x}_{t-1}+W f\\left(U \\mathrm{x}_{t-2}+W f\\left(U \\mathrm{x}_{t-3}+\\ldots\\right)\\right)\\right)\\right) \\end{aligned} \\end{equation} $$ ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œå¾ªç¯ç¥ç»ç½‘ç»œçš„è¾“å‡ºå€¼ $o_t$ ï¼Œæ˜¯å—å‰é¢å†æ¬¡è¾“å…¥å€¼ $\\mathrm{x}_ t , \\mathrm{x}_ {t-1} , \\mathrm{x}_ {t-2} , \\mathrm{x}_ {t-3} , \\ldots$ å½±å“çš„. æœ‰äº†ä»¥ä¸Šçš„è®²è§£ï¼Œæˆ‘ä»¬å°†å¾ˆå®¹æ˜“ç†è§£è®ºæ–‡ä¸­çš„è¿™ä¸€éƒ¨åˆ†å†…å®¹.\n$$ \\begin{equation} \\begin{gathered} \\boldsymbol{h}_t=\\sigma^{(h)}\\left(\\boldsymbol{W}^{(h)} \\cdot \\boldsymbol{h}_{t-1}+\\boldsymbol{W}^{(x)} \\cdot \\boldsymbol{x}_t\\right) \\\\ y_t=\\sigma^{(y)}\\left(\\boldsymbol{W}^{(y)} \\cdot \\boldsymbol{h}_t\\right) \\end{gathered} \\label{eq3} \\end{equation} $$ å¼•å…¥æ³¢åŠ¨æ–¹ç¨‹ä¸RNNç›¸ç»“åˆ æ³¢çš„æ ‡é‡åˆ†å¸ƒä¸º $u(x, y, z)$ ï¼Œå…¶å«æ—¶æ¼”åŒ–è¿‡ç¨‹å¯ä»¥ç”±ä»¥ä¸‹æ–¹ç¨‹è¿›è¡Œæè¿°\n$$ \\begin{equation} \\frac{\\partial^2 u}{\\partial t^2}-c^2 \\cdot \\nabla^2 u=f \\end{equation} $$\nå…¶ä¸­ï¼Œ $\\nabla^2=\\frac{\\partial^2}{\\partial x^2}+\\frac{\\partial^2}{\\partial y^2}+\\frac{\\partial^2}{\\partial z^2}$ æ˜¯Laplaceç®—ç¬¦, $c=c(x, y, z)$ æ˜¯ç©ºé—´ä¸­çš„æ³¢é€Ÿä¸”ä¼šéšç©ºé—´ä½ç½®çš„ä¸åŒå‘ç”Ÿå˜åŒ–ï¼Œ $f=f(x, y, z, t)$ æ˜¯åŸå‡½æ•°é¡¹. å¯¹ Eq. 4 è¿›è¡Œæœ‰é™å·®åˆ†ç¦»æ•£ï¼Œæ—¶é—´æ­¥é•¿ä¸º$\\Delta t$ï¼Œå¾—åˆ°é€’å½’å…³ç³»æ–¹ç¨‹\n$$ \\frac{u_{t+1}-2 u_t+u_{t-1}}{\\Delta t^2}-c^2 \\cdot \\nabla^2 u_t=f_t $$\nå°†ä»¥ä¸Šçš„å·®åˆ†æ–¹ç¨‹å¯ä»¥è½¬åŒ–ä¸º\n$$ \\begin{equation} \\left[\\begin{array}{c} u_{t+1} \\\\ u_t \\end{array}\\right]=\\left[\\begin{array}{cc} 2+\\Delta t^2 \\cdot c^2 \\cdot \\nabla^2 \u0026 -1 \\\\ 1 \u0026 0 \\end{array}\\right] \\cdot\\left[\\begin{array}{c} u_t \\\\ u_{t-1} \\end{array}\\right]+\\Delta t^2 \\cdot\\left[\\begin{array}{c} f_t \\\\ 0 \\end{array}\\right] \\end{equation} $$ ç»“åˆ Eq. \\eqref{eq3} æˆ‘ä»¬å¾ˆå®¹æ˜“ä¼šå¾—åˆ°ç›¸å¯¹åº”çš„å½¢å¼\n$$ \\begin{equation} \\begin{aligned} \\boldsymbol{h}_t \u0026 =\\boldsymbol{A}\\left(\\boldsymbol{h}_{t-1}\\right) \\cdot \\boldsymbol{h}_{t-1}+\\boldsymbol{P}^{(\\mathrm{i})} \\cdot \\boldsymbol{x}_t \\\\ \\boldsymbol{y}_t \u0026 =\\left|\\boldsymbol{P}^{(\\mathrm{o})} \\cdot \\boldsymbol{h}_t\\right|^2 \\end{aligned} \\end{equation} $$ æ–¹ç¨‹ä¸­ $c=c(x, y, z)$ éƒ¨åˆ†å¯¹åº”äºææ–™å†…çš„ç‰©ç†æ„å‹å’Œå¸ƒå±€. ä¸æ ‡å‡†RNNç±»ä¼¼ï¼Œéšè—çŠ¶æ€ä¸æ³¢åŠ¨æ–¹ç¨‹è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„è”ç³»ç”±çº¿æ€§ç®—å­ $\\boldsymbol{P}^{(\\mathrm{i})}$ å’Œ $\\boldsymbol{P}^{(\\mathrm{o})}$ å®šä¹‰. ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸¤ä¸ªçº¿æ€§ç®—å­è¿›è¡Œè¯¦ç»†çš„åˆ†æï¼Œæ ¹æ®æ–‡ä¸­ä½œè€…çš„è¯´æ³•1\n$$ \\begin{equation} \\begin{aligned} \\boldsymbol{P}^{(\\mathrm{i})} \u0026 \\equiv\\left[\\begin{array}{c} \\boldsymbol{M}^{(\\mathrm{i})} \\\\ \\mathbf{o} \\end{array}\\right] \\\\ \\boldsymbol{P}^{(\\mathrm{o})} \u0026 \\equiv\\left[\\boldsymbol{M}^{(\\mathrm{o}) T}, \\mathbf{o}\\right] \\end{aligned} \\end{equation} $$ å…¶ä¸­ï¼Œ$\\mathrm{o}$ æ˜¯é›¶çŸ©é˜µï¼Œç›¸å¯¹åº”çš„å½¢å¼åœ¨äºæŠŠè¾“å…¥å‘é‡ $\\boldsymbol{x}_ t$ çš„è¾“å…¥å†™æˆçŸ©é˜µå‘é‡çš„ä¹˜æ³•å½¢å¼ï¼š\n$$ \\Delta t^2 \\boldsymbol{f}_t\\equiv \\boldsymbol{M}^{(i)} \\cdot \\boldsymbol{x}_t $$\nç‰¹åˆ«æ³¨æ„ï¼ŒRNNåœ¨æ¯ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºæ˜¯ç”±æ ‡é‡åœºçš„å¼ºåº¦æµ‹é‡ç»™å‡ºçš„ï¼Œ\n$$ \\boldsymbol{y}_ t=\\boldsymbol{M}^{(\\mathrm{o}) T} \\cdot \\boldsymbol{u}_t^2 $$\nä»¥ä¸Šä¾¿æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ç”¨æ¥è¯´æ˜RNNä¸æ³¢åŠ¨æ–¹ç¨‹çš„è”ç³».\nè®­ç»ƒç‰©ç†ç³»ç»Ÿ è¯¥è®ºæ–‡ä¸­æ¼”ç¤ºäº†æ³¢åŠ¨æ–¹ç¨‹çš„åŠ¨åŠ›å­¦å¦‚ä½•é€šè¿‡æ„é€ éå‡åŒ€ææ–™åˆ†å¸ƒæ¥è®­ç»ƒæ¥åˆ†ç±»å…ƒéŸ³çš„åˆ†ç±»ï¼Œae, ei, å’Œ iy. å›¾Dä¸­çš„é»‘è‰²ç‚¹æºå³ä¸ºéŸ³æº(ç±»æ¯”ä¸ºè¾“å…¥å±‚)ï¼Œé€šè¿‡ä¸­é—´æµ…è‰²éƒ¨åˆ†(éšè—å±‚)ä¼ æ’­ï¼Œå³è¾¹å®šä¹‰äº†ä¸‰ä¸ªæ¢æµ‹ç‚¹(è¾“å‡ºå±‚)ï¼Œæ¯ä¸ªæ¢æµ‹ç‚¹åˆ†é…ç»™ä¸‰ä¸ªå…ƒéŸ³ç±»ä¸­çš„ä¸€ä¸ªï¼Œå¯¹ç›¸å¯¹åº”çš„ç»“æœè¿›è¡Œåé¦ˆ. å›¾Cä¸­çš„çº¿å³ä¸ºä¸‰ä¸ªå…ƒéŸ³çš„åŠŸç‡ç§¯åˆ†ç»“æœ.\nä¸ºäº†æ–¹ä¾¿æ•°å€¼ç»“æœæ¼”ç¤ºï¼Œè€ƒè™‘ç”±ä¸¤ç§ææ–™ç»„æˆçš„äºŒå€¼åŒ–ç³»ç»Ÿï¼Œå½’ä¸€åŒ–åçš„æ³¢é€Ÿåˆ†åˆ«ä¸º $c_0=1.0$ å’Œ $c_1=0.5$. æœ¬æ–‡é‡‡ç”¨äº†åå‘ä¼˜åŒ–çš„ä¼ æ’­æ€è·¯ï¼ŒAdamçš„æ–¹æ³•å¯¹ææ–™å¯†åº¦å±æ€§è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå…¶ä¼˜åŒ–ç»“æœè¢«å±•ç¤ºåœ¨ä¸‹å›¾Dä¹‹ä¸­.\nå¼•å…¥ä¸€ä¸ªå¸æ”¶åŒºåŸŸæ¥è¿‘ä¼¼ä¸€ä¸ªå¯¹åº”çš„è¾¹ç•Œæ¡ä»¶ï¼Œå¯¹åº”äºå›¾Bä¸­çš„ç°è‰²åŒºåŸŸ. æ­¤å¤–ï¼Œä¸ä¼ ç»Ÿçš„RNNä¸åŒï¼Œæ³¢åŠ¨æ–¹ç¨‹æ–½åŠ äº†èƒ½é‡å®ˆæ’çº¦æŸï¼Œé˜²æ­¢éšæ€èŒƒæ•°å’Œè¾“å‡ºä¿¡å·çš„æ— é™å¢é•¿. è¯¥åŒºåŸŸç”±é˜»å°¼ç³»æ•° $b(r, y)$ å®šä¹‰ï¼Œå¸¦é˜»å°¼çš„æ ‡é‡æ³¢åŠ¨æ–¹ç¨‹å¯ä»¥å†™ä¸º\n$$ \\begin{equation} \\frac{\\partial^2 u}{\\partial t^2}+2 b \\cdot \\frac{\\partial u}{\\partial t}=c^2 \\cdot \\nabla^2 u+f \\end{equation} $$\nå…¶ä¸­ï¼Œ$u$ ä¸ºæœªçŸ¥æ ‡é‡å­—æ®µï¼Œ$b$ ä¸ºé˜»å°¼ç³»æ•°. åœ¨æ•°å­¦å½¢å¼ä¸Šï¼Œè¯¥è®ºæ–‡å¯¹æ­¤ç®€åŒ–ä¸º\n$$ \\begin{equation} b(u)=\\frac{b_0}{1+(\\frac{u}{u_\\mathrm{th}})^2}. \\end{equation} $$\nå‡è®¾ $b$ å¯ä»¥åœ¨ç©ºé—´ä¸Šå˜åŒ–ï¼Œä½†ä¸é¢‘ç‡æ— å…³. å¯¹äºä»¥ $t$ ä¸ºç´¢å¼•çš„æ—¶é—´æ­¥é•¿ï¼Œç”¨äºŒé˜¶å¾®åˆ†çš„ä¸­å¿ƒå·®åˆ†å…¬å¼\n$$ \\begin{equation} \\frac{u_{t+1}-2 u_t+u_{t-1}}{\\Delta t^2}+2 b \\frac{u_{t+1}-u_{t-1}}{2 \\Delta t}=c^2 \\nabla^2 u_t+f_t \\end{equation} $$\nç°åœ¨å¯ä»¥ç”¨ $u_{t+1}$ å½¢æˆä¸€ä¸ªé€’å½’å…³ç³»ï¼Œä»è€Œå¾—åˆ°\n$$ \\begin{equation} \\begin{aligned} \u0026 \\left(\\frac{1}{\\Delta t^2}+\\frac{b}{\\Delta t}\\right) u_{t+1}-\\frac{2}{\\Delta t^2} u_t+\\left(\\frac{1}{\\Delta t^2}-\\frac{b}{\\Delta t}\\right) u_{t-1}=c^2 \\cdot \\nabla^2 u_t+f_t \\\\ \u0026 \\left(\\frac{1}{\\Delta t^2}+\\frac{b}{\\Delta t}\\right) u_{t+1}=\\frac{2}{\\Delta t^2} u_t-\\left(\\frac{1}{\\Delta t^2}-\\frac{b}{\\Delta t}\\right) u_{t-1}+c^2 \\cdot \\nabla^2 u_t+f_t \\\\ u_{t+1}= \u0026 \\left(\\frac{1}{\\Delta t^2}+\\frac{b}{\\Delta t}\\right)^{-1}\\left[\\frac{2}{\\Delta t^2} u_t-\\left(\\frac{1}{\\Delta t^2}-\\frac{b}{\\Delta t}\\right) u_{t-1}+c^2 \\cdot \\nabla^2 u_t+f_t\\right] \\end{aligned} \\end{equation} $$ ç±»æ¯”å¸¸è§„çš„æ³¢åŠ¨æ–¹ç¨‹å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åœ¨è®ºæ–‡ä¸­å®é™…è€ƒè™‘é˜»å°¼ç³»æ•°é¡¹çš„å½¢å¼ï¼š\n$$ \\begin{equation} \\left[\\begin{array}{c} u_{t+1} \\\\ u_t \\end{array}\\right]=\\left[\\begin{array}{cc} \\frac{2+\\Delta t^2 \\cdot c^2 \\cdot \\nabla^2}{1+\\Delta t \\cdot b} \u0026 \\frac{-1-\\Delta t \\cdot b}{1+\\Delta t \\cdot b} \\\\ 1 \u0026 0 \\end{array}\\right] \\cdot\\left[\\begin{array}{c} u_t \\\\ u_{t-1} \\end{array}\\right]+\\Delta t^2 \\cdot\\left[\\begin{array}{c} f_t \\\\ 0 \\end{array}\\right] \\end{equation} $$ ä½œè€…åœ¨æ–‡ä¸­æåˆ°åœ¨æ•°å€¼è®¡ç®—ä¸­ï¼Œå¯¹äºç®—ç¬¦ $\\nabla^2$ çš„å¤„ç†é‡‡å–äº†ç¦»æ•£å½¢å¼çš„å¤„ç†\n$$ \\nabla^2 u_t=\\frac{1}{h^2}\\left[\\begin{array}{ccc} 0 \u0026 1 \u0026 0 \\\\ 1 \u0026 -4 \u0026 1 \\\\ 0 \u0026 1 \u0026 0 \\end{array}\\right] * u_t $$ å…¶ä¸­ï¼Œ$h$ ä¸ºç©ºé—´ç½‘æ ¼çš„æ­¥é•¿ï¼ŒåŒæ—¶$*$æŒ‡çš„æ˜¯å·ç§¯è¿ç®—. ä¹‹æ‰€ä»¥é‡‡å–äº†è¿™æ ·çš„ä¸€ä¸ªå½¢å¼ï¼ŒåŒæ ·ä¹Ÿæ˜¯é‡‡ç”¨äº†äºŒé˜¶å¾®åˆ†çš„è¿‘ä¼¼. é¦–å…ˆå¼•å…¥è¿™ä¸ªåˆšåˆšè®²è¿‡çš„äºŒé˜¶å¾®åˆ†:\n$$ \\begin{equation} \\nabla^2 f=\\frac{\\partial^2 f}{\\partial x^2}+\\frac{\\partial^2 f}{\\partial y^2} \\end{equation} $$\nç”±è”ç³»äºŒé˜¶å·®åˆ†çš„æ€æƒ³:\n$$ \\begin{equation} \\begin{aligned} \u0026 \\frac{\\partial^2 f}{\\partial x^2}=f(x+1)-2f(x)+f(x-1) \\\\ \u0026 \\frac{\\partial^2 f}{\\partial y^2}=f(y+1)-2f(y)+f(y-1) \\end{aligned} \\end{equation} $$ é‚£ä¹ˆå¾—åˆ°ä¸Šè¿°äºŒé˜¶å¾®åˆ†ï¼š\n$$ \\begin{equation} \\begin{aligned} \\nabla^2 f \u0026=\\frac{\\partial^2 f}{\\partial x^2}+\\frac{\\partial^2 f}{\\partial y^2}\\\\ \u0026=[f(x+1, y)+f(x-1, y)+f(x, y+1)+f(x, y-1)-4 f(x, y)] \\end{aligned} \\end{equation} $$ ç›¸å¯¹åº”çš„ç³»æ•°å³ä¸ºç›¸åº”çš„çŸ©é˜µå½¢å¼\n$$ \\begin{equation} \\left[\\begin{array}{ccc} 0 \u0026 1 \u0026 0 \\\\ 1 \u0026 -4 \u0026 1 \\\\ 0 \u0026 1 \u0026 0 \\end{array}\\right] \\end{equation} $$ è®­ç»ƒæ•°å€¼æ¨¡å‹åŠå…¶ç›¸åº”ç»“æœ ä¸‹å›¾è®¡ç®—ç»“æœä¸­å›¾A-Dä»£è¡¨ç€ä¸åŒæ•°æ®é›†å¯¹åº”çš„æ··æ·†çŸ©é˜µ. åœ¨åŸºäºæ·±åº¦å­¦ä¹ çš„åˆ†ç±»è¯†åˆ«é¢†åŸŸä¸­ï¼Œç»å¸¸é‡‡ç”¨ç»Ÿè®¡å­¦ä¸­çš„æ··æ·†çŸ©é˜µï¼ˆconfusion matrixï¼‰æ¥è¯„ä»·åˆ†ç±»å™¨çš„æ€§èƒ½. å®ƒæ˜¯ä¸€ç§ç‰¹å®šçš„äºŒç»´çŸ©é˜µï¼šåˆ—ä»£è¡¨é¢„æµ‹çš„ç±»åˆ«ï¼›è¡Œä»£è¡¨å®é™…çš„ç±»åˆ«.\nå¯¹è§’çº¿ä¸Šçš„å€¼è¡¨ç¤ºé¢„æµ‹æ­£ç¡®çš„æ•°é‡æˆ–æ¯”ä¾‹ï¼›éå¯¹è§’çº¿å…ƒç´ æ˜¯é¢„æµ‹é”™è¯¯çš„éƒ¨åˆ†. æ··æ·†çŸ©é˜µçš„å¯¹è§’çº¿å€¼è¶Šé«˜è¶Šå¥½ï¼Œè¡¨æ˜è®¸å¤šæ­£ç¡®çš„é¢„æµ‹. ç‰¹åˆ«æ˜¯åœ¨å„åˆ†ç±»æ•°æ®çš„æ•°é‡ä¸å¹³è¡¡çš„æƒ…å†µä¸‹ï¼Œæ··æ·†çŸ©é˜µå¯ä»¥ç›´è§‚çš„æ˜¾ç¤ºåˆ†ç±»æ¨¡å‹å¯¹åº”å„ä¸ªç±»åˆ«çš„å‡†ç¡®ç‡.\nè¯¥ç³»ç»Ÿç›¸å¯¹äºè®­ç»ƒæ•°æ®é›†çš„å¹³å‡å‡†ç¡®ç‡ä¸º $92.6Â±1.1$%ï¼Œæµ‹è¯•æ•°æ®é›†å¹³å‡å‡†ç¡®ç‡ä¸º $86.3Â±4.3$%. è§‚å¯Ÿåˆ°è¯¥ç³»ç»Ÿåœ¨aeå…ƒéŸ³ä¸Šè·å¾—äº†è¿‘ä¹å®Œç¾çš„é¢„æµ‹æ€§èƒ½ï¼Œå¹¶ä¸”èƒ½å¤ŸåŒºåˆ†iyå…ƒéŸ³å’Œeiå…ƒéŸ³ï¼Œä½†å‡†ç¡®æ€§è¾ƒä½ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¥è‡ªæµ‹è¯•æ•°æ®é›†çš„æœªè§æ ·æœ¬ä¸­.\næ€»ç»“ ä½¿ç”¨ç‰©ç†æ¥æ‰§è¡Œè®¡ç®—çš„æ–¹æ³•å¯èƒ½ä¼šæˆä¸ºæ¨¡æ‹Ÿæœºå™¨å­¦ä¹ è®¾å¤‡çš„æ–°å¹³å°ï¼Œç›¸æ¯”é€šè¿‡è®¡ç®—æœºè¿›è¡Œæœºå™¨å­¦ä¹ æ›´è‡ªç„¶ã€æ›´æœ‰æ•ˆåœ°æ‰§è¡Œè®¡ç®—çš„æ½œåŠ›. é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ç¯‡è®ºæ–‡åŒæ ·å‘äººæ·±çœï¼Œåœ¨ç›¸å¯¹åº”çš„å…¶å®ƒç‰©ç†ç³»ç»Ÿä¸­ä»ç„¶å¯ä»¥æ‰¾åˆ°ç›¸ä¼¼å¯¹åº”çš„ç»“æ„ï¼Œä¾‹å¦‚å…‰å­¦ä¸­çš„å‚è½´è¡å°„æ–¹ç¨‹å’Œçƒ­ä¼ å¯¼æ–¹ç¨‹ï¼Œå®ƒä»¬ä¸æ³¢åŠ¨æ–¹ç¨‹éƒ½æœ‰ç›¸ä¼¼çš„ç»“æ„.\nReference Hughes, Tyler W., et al. â€œWave physics as an analog recurrent neural network.â€ Science advances 5.12 (2019): eaay6946.Â â†©ï¸\n",
  "wordCount" : "2348",
  "inLanguage": "en",
  "datePublished": "2023-01-10T12:14:32+08:00",
  "dateModified": "2023-01-10T12:14:32+08:00",
  "author":{
    "@type": "Person",
    "name": "wowking"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://wowking2018.github.io/posts/2023-01-10-wave-physics-as-an-analog-recurrent-neural-network/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Love and Share",
    "logo": {
      "@type": "ImageObject",
      "url": "https://wowking2018.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://wowking2018.github.io/" accesskey="h" title="Love and Share (Alt + H)">Love and Share</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://wowking2018.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://wowking2018.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://wowking2018.github.io/search/" title="ğŸ” (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post" autonumbering>
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Wave physics as an analog recurrent neural network
    </h1>
    <div class="post-meta"><span title='2023-01-10 12:14:32 +0800 CST'>2023-01-10</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;wowking

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#rnn%e4%bb%8b%e7%bb%8d" aria-label="RNNä»‹ç»">RNNä»‹ç»</a></li>
                    <li>
                        <a href="#%e5%bc%95%e5%85%a5%e6%b3%a2%e5%8a%a8%e6%96%b9%e7%a8%8b%e4%b8%8ernn%e7%9b%b8%e7%bb%93%e5%90%88" aria-label="å¼•å…¥æ³¢åŠ¨æ–¹ç¨‹ä¸RNNç›¸ç»“åˆ">å¼•å…¥æ³¢åŠ¨æ–¹ç¨‹ä¸RNNç›¸ç»“åˆ</a></li>
                    <li>
                        <a href="#%e8%ae%ad%e7%bb%83%e7%89%a9%e7%90%86%e7%b3%bb%e7%bb%9f" aria-label="è®­ç»ƒç‰©ç†ç³»ç»Ÿ">è®­ç»ƒç‰©ç†ç³»ç»Ÿ</a></li>
                    <li>
                        <a href="#%e8%ae%ad%e7%bb%83%e6%95%b0%e5%80%bc%e6%a8%a1%e5%9e%8b%e5%8f%8a%e5%85%b6%e7%9b%b8%e5%ba%94%e7%bb%93%e6%9e%9c" aria-label="è®­ç»ƒæ•°å€¼æ¨¡å‹åŠå…¶ç›¸åº”ç»“æœ">è®­ç»ƒæ•°å€¼æ¨¡å‹åŠå…¶ç›¸åº”ç»“æœ</a></li>
                    <li>
                        <a href="#%e6%80%bb%e7%bb%93" aria-label="æ€»ç»“">æ€»ç»“</a></li>
                    <li>
                        <a href="#reference" aria-label="Reference">Reference</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>
  <div class="post-content"><h3 id="rnnä»‹ç»">RNNä»‹ç»<a hidden class="anchor" aria-hidden="true" href="#rnnä»‹ç»">#</a></h3>
<p>RNN(å¾ªç¯ç¥ç»ç½‘ç»œ)æ˜¯åœ¨<strong>è‡ªç„¶è¯­è¨€å¤„ç†</strong>NLPé¢†åŸŸä¸­æœ€å…ˆè¢«ç”¨èµ·æ¥çš„ï¼Œæ¯”å¦‚ï¼ŒRNNå¯ä»¥ä¸º<strong>è¯­è¨€æ¨¡å‹</strong>æ¥å»ºæ¨¡. å¾ªç¯ç¥ç»ç½‘ç»œç§ç±»ç¹å¤šï¼Œæœ€ç®€å•çš„åŸºæœ¬å¾ªç¯ç¥ç»ç½‘ç»œå¯ä»¥è¢«ç†è§£ä¸ºéšè—å±‚å†…å¾ªç¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="../pic/2023-01-10-Wave physics as an analog recurrent neural network/fig (1).jpg" style="zoom: 100%; display: block; margin: 0 auto;" width="120px" alt = ""/>
<p>å¦‚æœæˆ‘ä»¬æŠŠä¸Šé¢çš„å›¾å±•å¼€ï¼Œ<strong>å¾ªç¯ç¥ç»ç½‘ç»œ</strong>ä¹Ÿå¯ä»¥ç”»æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p>
<img src="../pic/2023-01-10-Wave physics as an analog recurrent neural network/fig (2).jpg" style="zoom: 100%; display: block; margin: 0 auto;" width="600px" alt = ""/>
<p>ç°åœ¨çœ‹ä¸Šå»å°±æ¯”è¾ƒæ¸…æ¥šäº†ï¼Œè¿™ä¸ªç½‘ç»œåœ¨ $t$ æ—¶åˆ»æ¥æ”¶åˆ°è¾“å…¥ $\mathrm{x}_ {t}$ ä¹‹åï¼Œéšè—å±‚çš„å€¼æ˜¯ $\mathrm{s} _ {t}$ ï¼Œè¾“å‡ºå€¼æ˜¯ $\mathrm{o}_ {t}$. å…³é”®ä¸€ç‚¹æ˜¯ï¼Œ $\mathrm{s}_ {t}$ çš„å€¼ä¸ä»…ä»…å–å†³äº $\mathrm{x}_ {t}$ , è¿˜å–å†³äº $\mathrm{s}_ {t-1}$ . æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼æ¥è¡¨ç¤ºå¾ªç¯ç¥ç»ç½‘ç»œçš„è®¡ç®—æ–¹æ³•:</p>
<div>
$$
\begin{equation}
    \begin{aligned}
        & \mathrm{o}_t=g\left(V \mathrm{~s}_t\right)\\
        & \left.\mathrm{s}_t=f\left(U \mathrm{x}_t+W \mathrm{~s}_{t-1}\right) \right. 
    \end{aligned} \label{eq1}
\end{equation}
$$
</div>
<p>è¾“å‡ºå±‚æ˜¯ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œä¹Ÿå°±æ˜¯å®ƒçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å’Œéš è—å±‚çš„æ¯ä¸ªèŠ‚ç‚¹ç›¸è¿. $\mathrm{V}$ æ˜¯è¾“å‡ºå±‚çš„æƒé‡çŸ©é˜µï¼Œ $g$ æ˜¯æ¿€æ´»å‡½æ•°. éšè—å±‚æ˜¯å¾ªç¯å±‚. ${U}$ æ˜¯è¾“å…¥ $x$ çš„æƒé‡çŸ©é˜µï¼Œ ${W}$ æ˜¯ä¸Šä¸€æ¬¡çš„å€¼ $\mathrm{s}_ {t-1}$ ä½œä¸ºè¿™ä¸€æ¬¡çš„ è¾“å…¥çš„æƒé‡çŸ©é˜µï¼Œ $f$æ˜¯æ¿€æ´»å‡½æ•°.</p>
<p>ä» Eq. \eqref{eq1} ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¾ªç¯å±‚å’Œå…¨è¿æ¥å±‚çš„åŒºåˆ«å°±æ˜¯å¾ªç¯å±‚å¤šäº†ä¸€ä¸ªæƒé‡çŸ©é˜µ $W$. å¦‚æœåå¤æŠŠéšè—å±‚çš„è®¡ç®—å…¬å¼å¸¦å…¥åˆ°è¾“å‡ºå±‚ï¼Œæˆ‘ä»¬å°†å¾—åˆ°:</p>
<div>
$$
\begin{equation}
    \begin{aligned}
    \mathrm{o}_t & =g\left(V \mathrm{~s}_t\right) \\
    & =V f\left(U \mathrm{x}_t+W \mathrm{~s}_{t-1}\right) \\
    & =V f\left(U \mathrm{x}_t+W f\left(U \mathrm{x}_{t-1}+W \mathrm{~s}_{t-2}\right)\right) \\
    & =V f\left(U \mathrm{x}_t+W f\left(U \mathrm{x}_{t-1}+W f\left(U \mathrm{x}_{t-2}+W \mathrm{~s}_{t-3}\right)\right)\right) \\
    & =V f\left(U \mathrm{x}_t+W f\left(U \mathrm{x}_{t-1}+W f\left(U \mathrm{x}_{t-2}+W f\left(U \mathrm{x}_{t-3}+\ldots\right)\right)\right)\right)
    \end{aligned}
\end{equation}
$$
</div>
<p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œå¾ªç¯ç¥ç»ç½‘ç»œçš„è¾“å‡ºå€¼ $o_t$ ï¼Œæ˜¯å—å‰é¢å†æ¬¡è¾“å…¥å€¼ $\mathrm{x}_ t , \mathrm{x}_ {t-1} , \mathrm{x}_ {t-2} , \mathrm{x}_ {t-3} , \ldots$ å½±å“çš„. æœ‰äº†ä»¥ä¸Šçš„è®²è§£ï¼Œæˆ‘ä»¬å°†å¾ˆå®¹æ˜“ç†è§£è®ºæ–‡ä¸­çš„è¿™ä¸€éƒ¨åˆ†å†…å®¹.</p>
<img src="../pic/2023-01-10-Wave physics as an analog recurrent neural network/fig (1).png" style="zoom: 100%; display: block; margin: 0 auto;" width="800px" alt = ""/>
<div>
$$
\begin{equation}
    \begin{gathered}
    \boldsymbol{h}_t=\sigma^{(h)}\left(\boldsymbol{W}^{(h)} \cdot \boldsymbol{h}_{t-1}+\boldsymbol{W}^{(x)} \cdot \boldsymbol{x}_t\right) \\
    y_t=\sigma^{(y)}\left(\boldsymbol{W}^{(y)} \cdot \boldsymbol{h}_t\right)
    \end{gathered} \label{eq3}
\end{equation} 
$$
</div>
<h3 id="å¼•å…¥æ³¢åŠ¨æ–¹ç¨‹ä¸rnnç›¸ç»“åˆ">å¼•å…¥æ³¢åŠ¨æ–¹ç¨‹ä¸RNNç›¸ç»“åˆ<a hidden class="anchor" aria-hidden="true" href="#å¼•å…¥æ³¢åŠ¨æ–¹ç¨‹ä¸rnnç›¸ç»“åˆ">#</a></h3>
<p>æ³¢çš„æ ‡é‡åˆ†å¸ƒä¸º $u(x, y, z)$ ï¼Œå…¶å«æ—¶æ¼”åŒ–è¿‡ç¨‹å¯ä»¥ç”±ä»¥ä¸‹æ–¹ç¨‹è¿›è¡Œæè¿°</p>
<p>$$
\begin{equation}
\frac{\partial^2 u}{\partial t^2}-c^2 \cdot \nabla^2 u=f
\end{equation}
$$</p>
<p>å…¶ä¸­ï¼Œ $\nabla^2=\frac{\partial^2}{\partial x^2}+\frac{\partial^2}{\partial y^2}+\frac{\partial^2}{\partial z^2}$ æ˜¯Laplaceç®—ç¬¦, $c=c(x, y, z)$ æ˜¯ç©ºé—´ä¸­çš„æ³¢é€Ÿä¸”ä¼šéšç©ºé—´ä½ç½®çš„ä¸åŒå‘ç”Ÿå˜åŒ–ï¼Œ $f=f(x, y, z, t)$ æ˜¯åŸå‡½æ•°é¡¹. å¯¹ Eq. 4 è¿›è¡Œæœ‰é™å·®åˆ†ç¦»æ•£ï¼Œæ—¶é—´æ­¥é•¿ä¸º$\Delta t$ï¼Œå¾—åˆ°é€’å½’å…³ç³»æ–¹ç¨‹</p>
<p>$$
\frac{u_{t+1}-2 u_t+u_{t-1}}{\Delta t^2}-c^2 \cdot \nabla^2 u_t=f_t
$$</p>
<img src="../pic/2023-01-10-Wave physics as an analog recurrent neural network/fig (2).png" style="zoom: 100%; display: block; margin: 0 auto;" width="800px" alt = ""/>
<p>å°†ä»¥ä¸Šçš„å·®åˆ†æ–¹ç¨‹å¯ä»¥è½¬åŒ–ä¸º</p>
<div>
$$
\begin{equation}
    \left[\begin{array}{c}
    u_{t+1} \\
    u_t
    \end{array}\right]=\left[\begin{array}{cc}
    2+\Delta t^2 \cdot c^2 \cdot \nabla^2 & -1 \\
    1 & 0
    \end{array}\right] \cdot\left[\begin{array}{c}
    u_t \\
    u_{t-1}
    \end{array}\right]+\Delta t^2 \cdot\left[\begin{array}{c}
    f_t \\
    0
    \end{array}\right]
\end{equation}
$$
</div>
<p>ç»“åˆ Eq. \eqref{eq3} æˆ‘ä»¬å¾ˆå®¹æ˜“ä¼šå¾—åˆ°ç›¸å¯¹åº”çš„å½¢å¼</p>
<div>
$$
\begin{equation}
    \begin{aligned}
    \boldsymbol{h}_t & =\boldsymbol{A}\left(\boldsymbol{h}_{t-1}\right) \cdot \boldsymbol{h}_{t-1}+\boldsymbol{P}^{(\mathrm{i})} \cdot \boldsymbol{x}_t \\
    \boldsymbol{y}_t & =\left|\boldsymbol{P}^{(\mathrm{o})} \cdot \boldsymbol{h}_t\right|^2
    \end{aligned}
\end{equation}
$$
</div>
<p>æ–¹ç¨‹ä¸­ $c=c(x, y, z)$ éƒ¨åˆ†å¯¹åº”äºææ–™å†…çš„ç‰©ç†æ„å‹å’Œå¸ƒå±€. ä¸æ ‡å‡†RNNç±»ä¼¼ï¼Œéšè—çŠ¶æ€ä¸æ³¢åŠ¨æ–¹ç¨‹è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„è”ç³»ç”±çº¿æ€§ç®—å­ $\boldsymbol{P}^{(\mathrm{i})}$ å’Œ $\boldsymbol{P}^{(\mathrm{o})}$ å®šä¹‰. ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸¤ä¸ªçº¿æ€§ç®—å­è¿›è¡Œè¯¦ç»†çš„åˆ†æï¼Œæ ¹æ®æ–‡ä¸­ä½œè€…çš„è¯´æ³•<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<div>
$$
\begin{equation}
    \begin{aligned}
    \boldsymbol{P}^{(\mathrm{i})} & \equiv\left[\begin{array}{c}
    \boldsymbol{M}^{(\mathrm{i})} \\
    \mathbf{o}
    \end{array}\right] \\
    \boldsymbol{P}^{(\mathrm{o})} & \equiv\left[\boldsymbol{M}^{(\mathrm{o}) T}, \mathbf{o}\right]
    \end{aligned}
\end{equation}
$$
</div>
<p>å…¶ä¸­ï¼Œ$\mathrm{o}$ æ˜¯é›¶çŸ©é˜µï¼Œç›¸å¯¹åº”çš„å½¢å¼åœ¨äºæŠŠè¾“å…¥å‘é‡ $\boldsymbol{x}_ t$ çš„è¾“å…¥å†™æˆçŸ©é˜µå‘é‡çš„ä¹˜æ³•å½¢å¼ï¼š</p>
<p>$$
\Delta t^2 \boldsymbol{f}_t\equiv \boldsymbol{M}^{(i)} \cdot \boldsymbol{x}_t
$$</p>
<p>ç‰¹åˆ«æ³¨æ„ï¼ŒRNNåœ¨æ¯ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºæ˜¯ç”±æ ‡é‡åœºçš„å¼ºåº¦æµ‹é‡ç»™å‡ºçš„ï¼Œ</p>
<p>$$
\boldsymbol{y}_ t=\boldsymbol{M}^{(\mathrm{o}) T} \cdot \boldsymbol{u}_t^2
$$</p>
<p>ä»¥ä¸Šä¾¿æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ç”¨æ¥è¯´æ˜RNNä¸æ³¢åŠ¨æ–¹ç¨‹çš„è”ç³».</p>
<h3 id="è®­ç»ƒç‰©ç†ç³»ç»Ÿ">è®­ç»ƒç‰©ç†ç³»ç»Ÿ<a hidden class="anchor" aria-hidden="true" href="#è®­ç»ƒç‰©ç†ç³»ç»Ÿ">#</a></h3>
<p>è¯¥è®ºæ–‡ä¸­æ¼”ç¤ºäº†æ³¢åŠ¨æ–¹ç¨‹çš„åŠ¨åŠ›å­¦å¦‚ä½•é€šè¿‡æ„é€ éå‡åŒ€ææ–™åˆ†å¸ƒæ¥è®­ç»ƒæ¥åˆ†ç±»å…ƒéŸ³çš„åˆ†ç±»ï¼Œae, ei, å’Œ iy. å›¾Dä¸­çš„é»‘è‰²ç‚¹æºå³ä¸ºéŸ³æº(ç±»æ¯”ä¸º<strong>è¾“å…¥å±‚</strong>)ï¼Œé€šè¿‡ä¸­é—´æµ…è‰²éƒ¨åˆ†(<strong>éšè—å±‚</strong>)ä¼ æ’­ï¼Œå³è¾¹å®šä¹‰äº†ä¸‰ä¸ªæ¢æµ‹ç‚¹(<strong>è¾“å‡ºå±‚</strong>)ï¼Œæ¯ä¸ªæ¢æµ‹ç‚¹åˆ†é…ç»™ä¸‰ä¸ªå…ƒéŸ³ç±»ä¸­çš„ä¸€ä¸ªï¼Œå¯¹ç›¸å¯¹åº”çš„ç»“æœè¿›è¡Œåé¦ˆ. å›¾Cä¸­çš„çº¿å³ä¸ºä¸‰ä¸ªå…ƒéŸ³çš„åŠŸç‡ç§¯åˆ†ç»“æœ.</p>
<p>ä¸ºäº†æ–¹ä¾¿æ•°å€¼ç»“æœæ¼”ç¤ºï¼Œè€ƒè™‘ç”±ä¸¤ç§ææ–™ç»„æˆçš„äºŒå€¼åŒ–ç³»ç»Ÿï¼Œå½’ä¸€åŒ–åçš„æ³¢é€Ÿåˆ†åˆ«ä¸º $c_0=1.0$ å’Œ $c_1=0.5$. æœ¬æ–‡é‡‡ç”¨äº†åå‘ä¼˜åŒ–çš„ä¼ æ’­æ€è·¯ï¼ŒAdamçš„æ–¹æ³•å¯¹ææ–™å¯†åº¦å±æ€§è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå…¶ä¼˜åŒ–ç»“æœè¢«å±•ç¤ºåœ¨ä¸‹å›¾Dä¹‹ä¸­.</p>
<img src="../pic/2023-01-10-Wave physics as an analog recurrent neural network/fig (3).png" style="zoom: 100%; display: block; margin: 0 auto;" width="800px" alt = ""/>
<p>å¼•å…¥ä¸€ä¸ªå¸æ”¶åŒºåŸŸæ¥è¿‘ä¼¼ä¸€ä¸ªå¯¹åº”çš„è¾¹ç•Œæ¡ä»¶ï¼Œå¯¹åº”äºå›¾Bä¸­çš„ç°è‰²åŒºåŸŸ. æ­¤å¤–ï¼Œä¸ä¼ ç»Ÿçš„RNNä¸åŒï¼Œæ³¢åŠ¨æ–¹ç¨‹æ–½åŠ äº†èƒ½é‡å®ˆæ’çº¦æŸï¼Œé˜²æ­¢éšæ€èŒƒæ•°å’Œè¾“å‡ºä¿¡å·çš„æ— é™å¢é•¿. è¯¥åŒºåŸŸç”±é˜»å°¼ç³»æ•° $b(r, y)$ å®šä¹‰ï¼Œå¸¦é˜»å°¼çš„æ ‡é‡æ³¢åŠ¨æ–¹ç¨‹å¯ä»¥å†™ä¸º</p>
<p>$$
\begin{equation}
\frac{\partial^2 u}{\partial t^2}+2 b \cdot \frac{\partial u}{\partial t}=c^2 \cdot \nabla^2 u+f
\end{equation}
$$</p>
<p>å…¶ä¸­ï¼Œ$u$ ä¸ºæœªçŸ¥æ ‡é‡å­—æ®µï¼Œ$b$ ä¸ºé˜»å°¼ç³»æ•°. åœ¨æ•°å­¦å½¢å¼ä¸Šï¼Œè¯¥è®ºæ–‡å¯¹æ­¤ç®€åŒ–ä¸º</p>
<p>$$
\begin{equation}
b(u)=\frac{b_0}{1+(\frac{u}{u_\mathrm{th}})^2}.
\end{equation}
$$</p>
<p>å‡è®¾ $b$ å¯ä»¥åœ¨ç©ºé—´ä¸Šå˜åŒ–ï¼Œä½†ä¸é¢‘ç‡æ— å…³. å¯¹äºä»¥ $t$ ä¸ºç´¢å¼•çš„æ—¶é—´æ­¥é•¿ï¼Œç”¨<strong>äºŒé˜¶å¾®åˆ†çš„ä¸­å¿ƒå·®åˆ†å…¬å¼</strong></p>
<p>$$
\begin{equation}
\frac{u_{t+1}-2 u_t+u_{t-1}}{\Delta t^2}+2 b \frac{u_{t+1}-u_{t-1}}{2 \Delta t}=c^2 \nabla^2 u_t+f_t
\end{equation}
$$</p>
<p>ç°åœ¨å¯ä»¥ç”¨ $u_{t+1}$ å½¢æˆä¸€ä¸ªé€’å½’å…³ç³»ï¼Œä»è€Œå¾—åˆ°</p>
<div>
$$
\begin{equation}
    \begin{aligned}
    & \left(\frac{1}{\Delta t^2}+\frac{b}{\Delta t}\right) u_{t+1}-\frac{2}{\Delta t^2} u_t+\left(\frac{1}{\Delta t^2}-\frac{b}{\Delta t}\right) u_{t-1}=c^2 \cdot \nabla^2 u_t+f_t \\
    & \left(\frac{1}{\Delta t^2}+\frac{b}{\Delta t}\right) u_{t+1}=\frac{2}{\Delta t^2} u_t-\left(\frac{1}{\Delta t^2}-\frac{b}{\Delta t}\right) u_{t-1}+c^2 \cdot \nabla^2 u_t+f_t \\
    u_{t+1}= & \left(\frac{1}{\Delta t^2}+\frac{b}{\Delta t}\right)^{-1}\left[\frac{2}{\Delta t^2} u_t-\left(\frac{1}{\Delta t^2}-\frac{b}{\Delta t}\right) u_{t-1}+c^2 \cdot \nabla^2 u_t+f_t\right]
    \end{aligned}
\end{equation}
$$
</div>
<p>ç±»æ¯”å¸¸è§„çš„æ³¢åŠ¨æ–¹ç¨‹å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åœ¨è®ºæ–‡ä¸­å®é™…è€ƒè™‘é˜»å°¼ç³»æ•°é¡¹çš„å½¢å¼ï¼š</p>
<div>
$$
\begin{equation}
    \left[\begin{array}{c}
    u_{t+1} \\
    u_t
    \end{array}\right]=\left[\begin{array}{cc}
    \frac{2+\Delta t^2 \cdot c^2 \cdot \nabla^2}{1+\Delta t \cdot b} & \frac{-1-\Delta t \cdot b}{1+\Delta t \cdot b} \\
    1 & 0
    \end{array}\right] \cdot\left[\begin{array}{c}
    u_t \\
    u_{t-1}
    \end{array}\right]+\Delta t^2 \cdot\left[\begin{array}{c}
    f_t \\
    0
    \end{array}\right]
\end{equation}
$$
</div>
<p>ä½œè€…åœ¨æ–‡ä¸­æåˆ°åœ¨æ•°å€¼è®¡ç®—ä¸­ï¼Œå¯¹äºç®—ç¬¦ $\nabla^2$ çš„å¤„ç†é‡‡å–äº†ç¦»æ•£å½¢å¼çš„å¤„ç†</p>
<div>
$$
\nabla^2 u_t=\frac{1}{h^2}\left[\begin{array}{ccc}
0 & 1 & 0 \\
1 & -4 & 1 \\
0 & 1 & 0
\end{array}\right] * u_t
$$
</div>
<p>å…¶ä¸­ï¼Œ$h$ ä¸ºç©ºé—´ç½‘æ ¼çš„æ­¥é•¿ï¼ŒåŒæ—¶$*$æŒ‡çš„æ˜¯å·ç§¯è¿ç®—. ä¹‹æ‰€ä»¥é‡‡å–äº†è¿™æ ·çš„ä¸€ä¸ªå½¢å¼ï¼ŒåŒæ ·ä¹Ÿæ˜¯é‡‡ç”¨äº†äºŒé˜¶å¾®åˆ†çš„è¿‘ä¼¼. é¦–å…ˆå¼•å…¥è¿™ä¸ªåˆšåˆšè®²è¿‡çš„äºŒé˜¶å¾®åˆ†:</p>
<p>$$
\begin{equation}
\nabla^2 f=\frac{\partial^2 f}{\partial x^2}+\frac{\partial^2 f}{\partial y^2}
\end{equation}
$$</p>
<p>ç”±è”ç³»äºŒé˜¶å·®åˆ†çš„æ€æƒ³:</p>
<div>
$$
\begin{equation}
    \begin{aligned}
    & \frac{\partial^2 f}{\partial x^2}=f(x+1)-2f(x)+f(x-1) \\
    & \frac{\partial^2 f}{\partial y^2}=f(y+1)-2f(y)+f(y-1)
    \end{aligned}
\end{equation}
$$
</div>
<p>é‚£ä¹ˆå¾—åˆ°ä¸Šè¿°äºŒé˜¶å¾®åˆ†ï¼š</p>
<div>
$$
\begin{equation}
    \begin{aligned}
    \nabla^2 f &=\frac{\partial^2 f}{\partial x^2}+\frac{\partial^2 f}{\partial y^2}\\
    &=[f(x+1, y)+f(x-1, y)+f(x, y+1)+f(x, y-1)-4 f(x, y)]
    \end{aligned}
\end{equation}
$$
</div>
<p>ç›¸å¯¹åº”çš„ç³»æ•°å³ä¸ºç›¸åº”çš„çŸ©é˜µå½¢å¼</p>
<div>
$$
\begin{equation}
    \left[\begin{array}{ccc}
    0 & 1 & 0 \\
    1 & -4 & 1 \\
    0 & 1 & 0
    \end{array}\right]
\end{equation}
$$
</div>
<h3 id="è®­ç»ƒæ•°å€¼æ¨¡å‹åŠå…¶ç›¸åº”ç»“æœ">è®­ç»ƒæ•°å€¼æ¨¡å‹åŠå…¶ç›¸åº”ç»“æœ<a hidden class="anchor" aria-hidden="true" href="#è®­ç»ƒæ•°å€¼æ¨¡å‹åŠå…¶ç›¸åº”ç»“æœ">#</a></h3>
<p>ä¸‹å›¾è®¡ç®—ç»“æœä¸­å›¾A-Dä»£è¡¨ç€ä¸åŒæ•°æ®é›†å¯¹åº”çš„æ··æ·†çŸ©é˜µ. åœ¨åŸºäºæ·±åº¦å­¦ä¹ çš„åˆ†ç±»è¯†åˆ«é¢†åŸŸä¸­ï¼Œç»å¸¸é‡‡ç”¨ç»Ÿè®¡å­¦ä¸­çš„æ··æ·†çŸ©é˜µï¼ˆconfusion matrixï¼‰æ¥è¯„ä»·<strong>åˆ†ç±»å™¨</strong>çš„æ€§èƒ½. å®ƒæ˜¯ä¸€ç§ç‰¹å®šçš„<strong>äºŒç»´çŸ©é˜µ</strong>ï¼šåˆ—ä»£è¡¨é¢„æµ‹çš„ç±»åˆ«ï¼›è¡Œä»£è¡¨å®é™…çš„ç±»åˆ«.</p>
<p>å¯¹è§’çº¿ä¸Šçš„å€¼è¡¨ç¤ºé¢„æµ‹æ­£ç¡®çš„æ•°é‡æˆ–æ¯”ä¾‹ï¼›éå¯¹è§’çº¿å…ƒç´ æ˜¯é¢„æµ‹é”™è¯¯çš„éƒ¨åˆ†. æ··æ·†çŸ©é˜µçš„å¯¹è§’çº¿å€¼è¶Šé«˜è¶Šå¥½ï¼Œè¡¨æ˜è®¸å¤šæ­£ç¡®çš„é¢„æµ‹. ç‰¹åˆ«æ˜¯åœ¨å„<strong>åˆ†ç±»æ•°æ®</strong>çš„æ•°é‡ä¸å¹³è¡¡çš„æƒ…å†µä¸‹ï¼Œæ··æ·†çŸ©é˜µå¯ä»¥ç›´è§‚çš„æ˜¾ç¤ºåˆ†ç±»æ¨¡å‹å¯¹åº”å„ä¸ªç±»åˆ«çš„å‡†ç¡®ç‡.</p>
<img src="../pic/2023-01-10-Wave physics as an analog recurrent neural network/fig (4).png" style="zoom: 100%; display: block; margin: 0 auto;" width="800px" alt = ""/>
<p>è¯¥ç³»ç»Ÿç›¸å¯¹äºè®­ç»ƒæ•°æ®é›†çš„å¹³å‡å‡†ç¡®ç‡ä¸º $92.6Â±1.1$%ï¼Œæµ‹è¯•æ•°æ®é›†å¹³å‡å‡†ç¡®ç‡ä¸º $86.3Â±4.3$%. è§‚å¯Ÿåˆ°è¯¥ç³»ç»Ÿåœ¨<code>ae</code>å…ƒéŸ³ä¸Šè·å¾—äº†è¿‘ä¹å®Œç¾çš„é¢„æµ‹æ€§èƒ½ï¼Œå¹¶ä¸”èƒ½å¤ŸåŒºåˆ†<code>iy</code>å…ƒéŸ³å’Œ<code>ei</code>å…ƒéŸ³ï¼Œä½†å‡†ç¡®æ€§è¾ƒä½ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¥è‡ªæµ‹è¯•æ•°æ®é›†çš„æœªè§æ ·æœ¬ä¸­.</p>
<h3 id="æ€»ç»“">æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#æ€»ç»“">#</a></h3>
<p>ä½¿ç”¨ç‰©ç†æ¥æ‰§è¡Œè®¡ç®—çš„æ–¹æ³•å¯èƒ½ä¼šæˆä¸ºæ¨¡æ‹Ÿæœºå™¨å­¦ä¹ è®¾å¤‡çš„æ–°å¹³å°ï¼Œç›¸æ¯”é€šè¿‡è®¡ç®—æœºè¿›è¡Œæœºå™¨å­¦ä¹ æ›´è‡ªç„¶ã€æ›´æœ‰æ•ˆåœ°æ‰§è¡Œè®¡ç®—çš„æ½œåŠ›. é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ç¯‡è®ºæ–‡åŒæ ·å‘äººæ·±çœï¼Œåœ¨ç›¸å¯¹åº”çš„å…¶å®ƒç‰©ç†ç³»ç»Ÿä¸­ä»ç„¶å¯ä»¥æ‰¾åˆ°ç›¸ä¼¼å¯¹åº”çš„ç»“æ„ï¼Œä¾‹å¦‚å…‰å­¦ä¸­çš„å‚è½´è¡å°„æ–¹ç¨‹å’Œçƒ­ä¼ å¯¼æ–¹ç¨‹ï¼Œå®ƒä»¬ä¸æ³¢åŠ¨æ–¹ç¨‹éƒ½æœ‰ç›¸ä¼¼çš„ç»“æ„.</p>
<h3 id="reference">Reference<a hidden class="anchor" aria-hidden="true" href="#reference">#</a></h3>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Hughes, Tyler W., et al. &ldquo;Wave physics as an analog recurrent neural network.&rdquo; Science advances 5.12 (2019): eaay6946.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://wowking2018.github.io/tags/machine-learning/">Machine Learning</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://wowking2018.github.io/posts/2023-07-01-hofstadter-butterfly/">
    <span class="title">Â« Prev</span>
    <br>
    <span>é‡å­åˆ†å½¢ä¸–ç•Œ-Hofstadterè´è¶</span>
  </a>
  <a class="next" href="https://wowking2018.github.io/posts/2022-06-19-what-is-entropy/">
    <span class="title">Next Â»</span>
    <br>
    <span>What is entropy?</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://wowking2018.github.io/">Love and Share</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
